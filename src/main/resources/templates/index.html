<!DOCTYPE html>
<html lang="kr">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>SLiPP Java Web Programming</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<!--[if lt IE 9]>
			<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<link href="css/styles.css" rel="stylesheet">
	</head>

    <body>
<nav class="navbar navbar-fixed-top header">
 	<div class="col-md-12">
        <div class="navbar-header">
            <a href="index.html" class="navbar-brand">SLiPP</a>
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse1">
          <i class="glyphicon glyphicon-search"></i>
          </button>
      
        </div>
        <div class="collapse navbar-collapse" id="navbar-collapse1">
          <form class="navbar-form pull-left">
              <div class="input-group" style="max-width:470px;">
                <input type="text" class="form-control" placeholder="Search" name="srch-term" id="srch-term">
                <div class="input-group-btn">
                  <button class="btn btn-default btn-primary" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                </div>
              </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
              <li>
                  <a id="userNameButton" style="display: none;"></a>
              </li>
             <li>
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-bell"></i></a>
                <ul class="dropdown-menu">
                  <li><a href="https://slipp.net" target="_blank">SLiPP</a></li>
                  <li><a href="https://facebook.com" target="_blank">Facebook</a></li>
                </ul>
             </li>
             <li><a href="./user/list.html"><i class="glyphicon glyphicon-user"></i></a></li>
           </ul>
        </div>	
     </div>	
</nav>
<div class="navbar navbar-default" id="subnav">
    <div class="col-md-12">
        <div class="navbar-header">
            <a href="#" style="margin-left:15px;" class="navbar-btn btn btn-default btn-plus dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-home" style="color:#dd1111;"></i> Home <small><i class="glyphicon glyphicon-chevron-down"></i></small></a>
            <ul class="nav dropdown-menu">
                <li><a href="user/profile.html"><i class="glyphicon glyphicon-user" style="color:#1111dd;"></i> Profile</a></li>
                <li class="nav-divider"></li>
                <li><a href="#"><i class="glyphicon glyphicon-cog" style="color:#dd1111;"></i> Settings</a></li>
            </ul>
            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse2">
            	<span class="sr-only">Toggle navigation</span>
            	<span class="icon-bar"></span>
            	<span class="icon-bar"></span>
            	<span class="icon-bar"></span>
            </button>            
        </div>
        <div class="collapse navbar-collapse" id="navbar-collapse2">
            <ul class="nav navbar-nav navbar-right">
                <li class="active"><a href="index.html">Posts</a></li>
                <li><a href="user/form.html" role="button" id="singUpButton" style="display: block;">회원가입</a></li>
                <li><a href="user/login.html" role="button" id="loginButton" style="display: block;">로그인</a></li>
                <!--
                <li><a href="#loginModal" role="button" data-toggle="modal">로그인</a></li>
                <li><a href="#registerModal" role="button" data-toggle="modal">회원가입</a></li>
                -->
                <li><a role="button" id="logoutButton" style="display: block;">로그아웃</a></li>
                <li><a href="#" role="button">개인정보수정</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="container" id="main">
   <div class="col-md-12 col-sm-12 col-lg-10 col-lg-offset-1">
      <div class="panel panel-default qna-list">
          <ul class="list" id="postList">

              </li>
          </ul>
          <div class="row">
              <div class="col-md-3"></div>
              <div class="col-md-6 text-center">
                  <ul class="pagination center-block" style="display:inline-block;">
                      <li><a href="#">«</a></li>
                      <li><a href="#">1</a></li>
                      <li><a href="#">2</a></li>
                      <li><a href="#">3</a></li>
                      <li><a href="#">4</a></li>
                      <li><a href="#">5</a></li>
                      <li><a href="#">»</a></li>
                </ul>
              </div>
              <div class="col-md-3 qna-write">
                  <a href="./qna/form.html" class="btn btn-primary pull-left" role="button">질문하기</a>
                  <a href="./post/write.html" class="btn btn-primary pull-right" role="button">글쓰기</a>
              </div>
          </div>
        </div>
    </div>
</div>

<!-- script references -->
<script src="js/jquery-2.2.0.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/scripts.js"></script>
<script defer src="js/logout.js"></script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        // 페이지 로딩이 완료되면 글 목록을 가져와서 표시합니다.
        fetchPostList();
    });

    function fetchPostList() {
        // 서버에서 글 목록을 가져오는 API 엔드포인트의 URL
        var apiUrl = "/post/list"; // 적절한 URL로 변경

        // fetch API를 사용하여 서버에서 JSON 데이터를 가져옵니다.
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                // 글 목록을 가져왔으면 화면에 표시합니다.
                displayPostList(data);
            })
            .catch(error => {
                console.error('Error fetching post list:', error);
            });
    }

    function displayPostList(posts) {
        // 가져온 글 목록을 돌면서 화면에 표시합니다.
        var postListContainer = document.getElementById("postList");

        posts.forEach(post => {
            var listItem = document.createElement("li");
            var formattedDate = formatDate(post.date); // 날짜 포맷 변경
            listItem.innerHTML = `
                    <div class="wrap">
                        <div class="main">
                            <strong class="subject">
                                <a href="/post/post_detail.html?id=${post.postId}">${post.title}</a>
                            </strong>
                            <div class="auth-info">
                                <i class="icon-add-comment"></i>
                                <span class="time">${formattedDate}</span>
                                <a href="/user/profile.html" class="author">${post.userName}</a>
                            </div>
                            <div class="reply" title="댓글">
                                <i class="icon-reply"></i>
                                <span class="point">${post.postId}</span>
                            </div>
                        </div>
                    </div>
                `;
            postListContainer.appendChild(listItem);
        });
    }

    function formatDate(dateString) {
        // 날짜 포맷 변경 함수
        var date = new Date(dateString);
        var options = { year: 'numeric', month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric' };
        return new Intl.DateTimeFormat('kr-KR', options).format(date);
    }
</script>


	</body>
</html>